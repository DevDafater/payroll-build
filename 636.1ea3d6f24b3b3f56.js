"use strict";(self.webpackChunkpayroll=self.webpackChunkpayroll||[]).push([[636],{9636:(me,D,s)=>{s.r(D),s.d(D,{ReportsModule:()=>de});var h=s(6895),x=s(4763),a=s(4006),p=s(5439),_=s(7579),c=s(2722),u=s(5999),e=s(4650),C=s(1543);let y=(()=>{class r{constructor(t){this.http=t}getPaySlipReport(t){return this.http.post("api/payroll/searchEmployeePaySlip",t)}getEmployeReport(t){return this.http.post("api/payroll/filterEmployeePayrollByDate",t)}getCompanyReport(t){return this.http.post("api/payroll/filterAllEmployeePayrollByDate",t)}getPaySlipReportDoc(t){return this.http.post("api/payroll/searchEmployeePaySlipReport",t)}getEmployeReportDoc(t){return this.http.post("api/payroll/filterEmployeePayrollByDateReport",t)}getCompanyReportDoc(t){return this.http.post("api/payroll/filterAllEmployeePayrollByDateReport",t)}sendEmail(t){return this.http.post("api/payroll/sendEmployeePaySlipReport",t)}}return r.\u0275fac=function(t){return new(t||r)(e.LFG(C.O))},r.\u0275prov=e.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();var g=s(9264),b=s(8423),v=s(4383),f=s(4463),Z=s(4294);function A(r,o){if(1&r&&(e.TgZ(0,"div",11),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.hij(" ",t.formErrors.firstDate,"")}}function T(r,o){if(1&r&&(e.TgZ(0,"div",11),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.hij(" ",t.formErrors.lastDate,"")}}function q(r,o){if(1&r){const t=e.EpF();e.TgZ(0,"div",12)(1,"app-button",8),e.NdJ("handleClick",function(){e.CHM(t);const l=e.oxw();return e.KtG(l.downloadReport("pdf"))}),e.ALo(2,"translate"),e.qZA()()}2&r&&(e.xp6(1),e.Q6J("buttonText",e.lcZ(2,1,"Download PDF")))}function w(r,o){if(1&r){const t=e.EpF();e.TgZ(0,"div",12)(1,"app-button",8),e.NdJ("handleClick",function(){e.CHM(t);const l=e.oxw();return e.KtG(l.downloadReport("excel"))}),e.ALo(2,"translate"),e.qZA()()}2&r&&(e.xp6(1),e.Q6J("buttonText",e.lcZ(2,1,"Download Excel")))}function F(r,o){if(1&r&&(e.TgZ(0,"th",19),e._uU(1),e.qZA()),2&r){const t=o.$implicit;e.xp6(1),e.Oqu(t)}}function Y(r,o){if(1&r&&(e.TgZ(0,"td",26),e._uU(1),e.qZA()),2&r){const t=o.$implicit;e.xp6(1),e.Oqu(null==t?null:t.amount)}}function E(r,o){if(1&r&&(e.TgZ(0,"td",26),e._uU(1),e.qZA()),2&r){const t=o.$implicit;e.xp6(1),e.Oqu(null==t?null:t.amount)}}function I(r,o){if(1&r&&(e.TgZ(0,"td",26),e._uU(1),e.qZA()),2&r){const t=o.$implicit;e.xp6(1),e.Oqu(null==t?null:t.amount)}}function U(r,o){if(1&r&&(e.TgZ(0,"td",26),e._uU(1),e.qZA()),2&r){const t=o.$implicit;e.xp6(1),e.Oqu(null==t?null:t.amount)}}function O(r,o){if(1&r&&(e.TgZ(0,"tr",22)(1,"td",23),e._uU(2),e.qZA(),e.TgZ(3,"td",23),e._uU(4),e.qZA(),e.TgZ(5,"td",24),e._uU(6),e.qZA(),e.YNc(7,Y,2,1,"td",25),e.YNc(8,E,2,1,"td",25),e.YNc(9,I,2,1,"td",25),e.YNc(10,U,2,1,"td",25),e.qZA()),2&r){const t=o.$implicit,i=o.index;e.xp6(2),e.hij(" ",null==t?null:t.name," "),e.xp6(2),e.hij(" ",null==t?null:t.empCode," "),e.xp6(2),e.Oqu(null==t||null==t.payroll[i]?null:t.payroll[i].month),e.xp6(1),e.Q6J("ngForOf",null==t?null:t.fixedIncome),e.xp6(1),e.Q6J("ngForOf",null==t?null:t.fixedDeductibles),e.xp6(1),e.Q6J("ngForOf",null==t?null:t.variableIncome),e.xp6(1),e.Q6J("ngForOf",null==t?null:t.variableDeductibles)}}function J(r,o){if(1&r&&(e.TgZ(0,"div",13)(1,"table",14)(2,"thead",15)(3,"tr",16)(4,"th",17),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"th",17),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"th",18),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"th",19),e._uU(14),e.ALo(15,"translate"),e.qZA(),e.TgZ(16,"th",19),e._uU(17),e.ALo(18,"translate"),e.qZA(),e.TgZ(19,"th",19),e._uU(20),e.ALo(21,"translate"),e.qZA(),e.TgZ(22,"th",19),e._uU(23),e.ALo(24,"translate"),e.qZA()(),e.TgZ(25,"tr",16),e.YNc(26,F,2,1,"th",20),e.qZA()(),e.TgZ(27,"tbody"),e.YNc(28,O,11,7,"tr",21),e.qZA()()()),2&r){const t=e.oxw();let i,l,n,d;e.xp6(5),e.Oqu(e.lcZ(6,13,"Employe Name")),e.xp6(3),e.Oqu(e.lcZ(9,15,"Employe Code")),e.xp6(3),e.Oqu(e.lcZ(12,17,"Month")),e.xp6(2),e.uIk("colspan",null!==(i=null==t.reportData[0]||null==t.reportData[0].fixedIncome?null:t.reportData[0].fixedIncome.length)&&void 0!==i?i:1),e.xp6(1),e.Oqu(e.lcZ(15,19,"Fixed Income")),e.xp6(2),e.uIk("colspan",null!==(l=null==t.reportData[0]||null==t.reportData[0].variableIncome?null:t.reportData[0].variableIncome.length)&&void 0!==l?l:1),e.xp6(1),e.Oqu(e.lcZ(18,21,"Variable Income")),e.xp6(2),e.uIk("colspan",null!==(n=null==t.reportData[0]||null==t.reportData[0].fixedDeductibles?null:t.reportData[0].fixedDeductibles.length)&&void 0!==n?n:1),e.xp6(1),e.Oqu(e.lcZ(21,23,"Fixed Deductibles")),e.xp6(2),e.uIk("colspan",null!==(d=null==t.reportData[0]||null==t.reportData[0].variableDeductibles?null:t.reportData[0].variableDeductibles.length)&&void 0!==d?d:1),e.xp6(1),e.Oqu(e.lcZ(24,25,"Variable Deductibles")),e.xp6(3),e.Q6J("ngForOf",t.tableSubHeadings),e.xp6(2),e.Q6J("ngForOf",t.reportData)}}let N=(()=>{class r{constructor(t,i,l,n,d,m){this.reportsService=t,this.employeService=i,this.spinner=l,this.toastr=n,this.translateService=d,this.fb=m,this.unsubscribe$=new _.x,this.employees=[],this.reportData=null,this.formErrors={firstDate:"",lastDate:""},this.formErrorMessages={firstDate:{required:"Start date is required"},lastDate:{required:"End date is required"}},this.fields=["fixedIncome","variableIncome","fixedDeductibles","variableDeductibles"],this.tableHeading=["Sr No.","Employe Name","Employe Code","Month","Fixed Income","Variable Income","Fixed Deductibles","Variabel Deductibles","Net Salary"],this.tableSubHeadings=["","",""],this.tableKeys=["sno","name","month","fixedIncome","variableIncome","fixedDeductibles","variableDeductibles","totalSalary"]}ngOnInit(){this.createFilterForm()}createFilterForm(){this.filterForm=this.fb.record({firstDate:[p().format("YYYY-MM"),a.kI.required],lastDate:[p().format("YYYY-MM"),a.kI.required]}),this.formErrors=(0,u.tm)(this.filterForm,this.formErrors,this.formErrorMessages,this.translateService),this.filterForm.valueChanges.subscribe(()=>{this.formErrors=(0,u.tm)(this.filterForm,this.formErrors,this.formErrorMessages,this.translateService)})}getReportData(){if(this.filterForm.invalid)return this.filterForm.markAllAsTouched(),void(this.formErrors=(0,u.tm)(this.filterForm,this.formErrors,this.formErrorMessages,this.translateService));this.spinner.show();const t={firstDate:p(this.filterForm.value.firstDate).set("date",1).format("YYYY-MM-DD"),lastDate:p(this.filterForm.value.lastDate).set("date",1).format("YYYY-MM-DD")};this.reportsService.getCompanyReport(t).pipe((0,c.R)(this.unsubscribe$)).subscribe(i=>{i?.success?(this.reportData=i?.data,this.fields.forEach(l=>{this.reportData[0][l]?.forEach(n=>{this.tableSubHeadings.push(n?.name)})}),console.log(this.tableSubHeadings),this.spinner.hide()):(this.toastr.error(this.translateService.instant(i?.message)),this.spinner.hide())},i=>{this.toastr.error(this.translateService.instant(i?.error?.message)),this.spinner.hide()})}downloadReport(t){const i={firstDate:p(this.filterForm.value.firstDate).set("date",1).format("YYYY-MM-DD"),lastDate:p(this.filterForm.value.lastDate).set("date",1).format("YYYY-MM-DD"),language:localStorage.getItem("Numetric|payroll_lang")??"en",type:t};this.spinner.show(),this.reportsService.getCompanyReportDoc(i).pipe((0,c.R)(this.unsubscribe$)).subscribe(l=>{const n=document.createElement("a"),d=new Blob([new Uint8Array(l.data.data)],{type:"excel"===t?"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":"application/pdf"}),m=window.URL.createObjectURL(d);n.href=m,n.download="Company Report",n.click(),window.URL.revokeObjectURL(m),this.toastr.success(this.translateService.instant("File downloaded"))},l=>{this.toastr.error(this.translateService.instant(l?.error?.error))},()=>this.spinner.hide())}ngOnDestroy(){this.unsubscribe$.next(null),this.unsubscribe$.complete()}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(y),e.Y36(g.m),e.Y36(b.t2),e.Y36(v._W),e.Y36(f.sK),e.Y36(a.qu))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-company-sheet"]],decls:20,vars:17,consts:[[1,"bg-white","rounded-xl","p-4","my-4"],[1,"w-1/2","flex","space-x-2","rtl:space-x-reverse","items-end",3,"formGroup"],[1,"w-1/4"],["for","firstDate",1,"text-sm","font-semibold"],["type","month","formControlName","firstDate",1,"border","p-1.5","rounded-lg",3,"max"],["class","text-sm text-red-500 ms-2 mt-1",4,"ngIf"],["for","lastDate",1,"text-sm","font-semibold"],["type","month","formControlName","lastDate",1,"border","p-1.5","rounded-lg",3,"min"],["type","primary","rounded","true",3,"buttonText","handleClick"],["class","w-1/3",4,"ngIf"],["class","mt-12",4,"ngIf"],[1,"text-sm","text-red-500","ms-2","mt-1"],[1,"w-1/3"],[1,"mt-12"],[1,"table-fixed"],[1,"bg-table-header"],[1,"bg-light-gray-1","mb-2"],["width","5%",1,"p-2","Gilroy-Bold","whitespace-nowrap","first:rounded-s-3xl","first:ps-4","last:pe-4","last:rounded-e-3xl"],["width","5%"],[1,"text-center","p-2","Gilroy-Bold","whitespace-nowrap","first:rounded-s-3xl","first:ps-4","last:pe-4","last:rounded-e-3xl"],["class","text-center p-2  Gilroy-Bold whitespace-nowrap first:rounded-s-3xl first:ps-4 last:pe-4 last:rounded-e-3xl",4,"ngFor","ngForOf"],["class","box-shadow-sales rounded-3xl mb-4 py-2 px-6 border-gray-200 border-b",4,"ngFor","ngForOf"],[1,"box-shadow-sales","rounded-3xl","mb-4","py-2","px-6","border-gray-200","border-b"],["width","5%",1,"p-2","whitespace-nowrap","first:ps-4","text-center"],["width","5%",1,"text-center"],["class","text-center",4,"ngFor","ngForOf"],[1,"text-center"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"label",3),e._uU(4),e.ALo(5,"translate"),e.qZA(),e._UZ(6,"input",4),e.YNc(7,A,2,1,"div",5),e.qZA(),e.TgZ(8,"div",2)(9,"label",6),e._uU(10),e.ALo(11,"translate"),e.qZA(),e._UZ(12,"input",7),e.YNc(13,T,2,1,"div",5),e.qZA(),e.TgZ(14,"div",2)(15,"app-button",8),e.NdJ("handleClick",function(){return i.getReportData()}),e.ALo(16,"translate"),e.qZA()(),e.YNc(17,q,3,3,"div",9),e.YNc(18,w,3,3,"div",9),e.qZA(),e.YNc(19,J,29,27,"div",10),e.qZA()),2&t&&(e.xp6(1),e.Q6J("formGroup",i.filterForm),e.xp6(3),e.Oqu(e.lcZ(5,11,"Select From Date")),e.xp6(2),e.Q6J("max",i.filterForm.value.lastDate),e.xp6(1),e.Q6J("ngIf",i.formErrors.firstDate),e.xp6(3),e.Oqu(e.lcZ(11,13,"Select To Date")),e.xp6(2),e.Q6J("min",i.filterForm.value.firstDate),e.xp6(1),e.Q6J("ngIf",i.formErrors.lastDate),e.xp6(2),e.Q6J("buttonText",e.lcZ(16,15,"Generate")),e.xp6(2),e.Q6J("ngIf",i.reportData),e.xp6(1),e.Q6J("ngIf",i.reportData),e.xp6(1),e.Q6J("ngIf",i.reportData))},dependencies:[h.sg,h.O5,Z.r,a.Fj,a.JJ,a.JL,a.sg,a.u,f.X$]}),r})();var R=s(656),S=s(2074);function M(r,o){if(1&r&&(e.TgZ(0,"div",19),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.hij(" ",t.formErrors.empId,"")}}function L(r,o){if(1&r&&(e.TgZ(0,"div",19),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.hij(" ",t.formErrors.paySlipDate,"")}}function P(r,o){if(1&r){const t=e.EpF();e.TgZ(0,"div",5)(1,"app-button",7),e.NdJ("handleClick",function(){e.CHM(t);const l=e.oxw();return e.KtG(l.downloadReport("pdf"))}),e.ALo(2,"translate"),e.qZA()()}2&r&&(e.xp6(1),e.Q6J("buttonText",e.lcZ(2,1,"Download PDF")))}function Q(r,o){if(1&r){const t=e.EpF();e.TgZ(0,"div",5)(1,"app-button",7),e.NdJ("handleClick",function(){e.CHM(t);const l=e.oxw();return e.KtG(l.downloadReport("excel"))}),e.ALo(2,"translate"),e.qZA()()}2&r&&(e.xp6(1),e.Q6J("buttonText",e.lcZ(2,1,"Download Excel")))}function k(r,o){if(1&r){const t=e.EpF();e.TgZ(0,"div",5)(1,"app-button",7),e.NdJ("handleClick",function(){e.CHM(t);const l=e.oxw();return e.KtG(l.emailModal=!0)}),e.ALo(2,"translate"),e.qZA()()}2&r&&(e.xp6(1),e.Q6J("buttonText",e.lcZ(2,1,"Send via Email")))}function $(r,o){if(1&r&&(e.TgZ(0,"div",33)(1,"div",32)(2,"p",36),e._uU(3),e.qZA(),e.TgZ(4,"p"),e._uU(5),e.ALo(6,"number"),e.qZA()()()),2&r){const t=o.$implicit;let i;e.xp6(3),e.hij("",null==t?null:t.name,":"),e.xp6(2),e.Oqu(e.xi3(6,2,null!==(i=null==t?null:t.amount)&&void 0!==i?i:0,".2-2"))}}function j(r,o){if(1&r&&(e.TgZ(0,"div",33)(1,"p",34),e._uU(2),e.qZA(),e.YNc(3,$,7,5,"div",31),e._UZ(4,"hr",35),e.qZA()),2&r){const t=o.$implicit,i=e.oxw(2);e.xp6(2),e.Oqu(i.fieldNames[t]),e.xp6(1),e.Q6J("ngForOf",null==i.paySlip?null:i.paySlip.payroll[t])}}function B(r,o){if(1&r&&(e.TgZ(0,"div",20)(1,"div",21)(2,"div")(3,"p",22),e._uU(4),e.qZA()(),e.TgZ(5,"div",23)(6,"div",24)(7,"p",25),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"p",26),e._uU(11),e.qZA()(),e.TgZ(12,"div",24)(13,"p",25),e._uU(14),e.ALo(15,"translate"),e.qZA(),e.TgZ(16,"p",26),e._uU(17),e.qZA()(),e.TgZ(18,"div",24)(19,"p",25),e._uU(20),e.ALo(21,"translate"),e.qZA(),e.TgZ(22,"p",26),e._uU(23),e.qZA()()(),e._UZ(24,"hr",27),e.TgZ(25,"div",28)(26,"p",29),e._uU(27),e.ALo(28,"translate"),e.qZA(),e.TgZ(29,"div",30),e.YNc(30,j,5,2,"div",31),e.TgZ(31,"div",32)(32,"p",25),e._uU(33),e.qZA(),e.TgZ(34,"p"),e._uU(35),e.ALo(36,"number"),e.qZA()()()()()()),2&r){const t=e.oxw();e.xp6(4),e.Oqu(null==t.paySlip?null:t.paySlip.name),e.xp6(4),e.hij("",e.lcZ(9,11,"Employe Code"),":"),e.xp6(3),e.Oqu(null==t.paySlip?null:t.paySlip.empCode),e.xp6(3),e.hij("",e.lcZ(15,13,"Email-Id"),":"),e.xp6(3),e.Oqu(null==t.paySlip?null:t.paySlip.email),e.xp6(3),e.hij("",e.lcZ(21,15,"Contact No"),":"),e.xp6(3),e.Oqu(null==t.paySlip?null:t.paySlip.contactNo),e.xp6(4),e.Oqu(e.lcZ(28,17,"Salary Breakdown")),e.xp6(3),e.Q6J("ngForOf",t.fields),e.xp6(3),e.hij("","Total Salary",":"),e.xp6(2),e.Oqu(e.xi3(36,19,null==t.paySlip||null==t.paySlip.payroll?null:t.paySlip.payroll.totalSalary,".2-2"))}}function G(r,o){1&r&&(e.TgZ(0,"div",37),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&r&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"Email is required")))}function H(r,o){1&r&&(e.TgZ(0,"div",37),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&r&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"Email must be in correct format")))}let K=(()=>{class r{constructor(t,i,l,n,d,m){this.reportsService=t,this.employeService=i,this.spinner=l,this.toastr=n,this.translateService=d,this.fb=m,this.unsubscribe$=new _.x,this.email=new a.NI("",[a.kI.required,a.kI.pattern(/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/)]),this.employees=[],this.paySlip=null,this.emailModal=!1,this.formErrors={empId:"",paySlipDate:""},this.formErrorMessages={empId:{required:"Select one employe to proceed"},paySlipDate:{required:"Payslip date is required"}},this.fields=["fixedIncome","fixedDeductibles","variableIncome","variableDeductibles"],this.fieldNames={fixedIncome:"Fixed Income",fixedDeductibles:"Fixed Deductibles",variableIncome:"Variable Income",variableDeductibles:"Variable Deductibles"}}ngOnInit(){this.createFilterForm(),this.getEmployees()}createFilterForm(){this.filterForm=this.fb.record({empId:[null,a.kI.required],paySlipDate:[p().format("YYYY-MM"),a.kI.required]}),this.formErrors=(0,u.tm)(this.filterForm,this.formErrors,this.formErrorMessages,this.translateService),this.filterForm.valueChanges.subscribe(()=>{this.formErrors=(0,u.tm)(this.filterForm,this.formErrors,this.formErrorMessages,this.translateService)})}getEmployees(){this.spinner.show(),this.employeService.getAllEmployes().pipe((0,c.R)(this.unsubscribe$)).subscribe(t=>{t?.success?(this.employees=t?.data,this.spinner.hide()):(this.toastr.error(this.translateService.instant(t?.message)),this.spinner.hide())},t=>{this.toastr.error(this.translateService.instant(t?.error?.message)),this.spinner.hide()})}getReportData(){if(this.filterForm.invalid)return this.filterForm.markAllAsTouched(),void(this.formErrors=(0,u.tm)(this.filterForm,this.formErrors,this.formErrorMessages,this.translateService));this.spinner.show();const t={...this.filterForm.value,paySlipDate:p(this.filterForm.value.paySlipDate).set("date",1).format("YYYY-MM-DD")};this.reportsService.getPaySlipReport(t).pipe((0,c.R)(this.unsubscribe$)).subscribe(i=>{i?.success?(this.paySlip={...i?.data,payroll:i?.data?.payroll[0]},this.spinner.hide()):(this.toastr.error(this.translateService.instant(i?.message)),this.spinner.hide())},i=>{this.toastr.error(this.translateService.instant(i?.error?.message)),this.spinner.hide()})}downloadReport(t){const i={...this.filterForm.value,paySlipDate:p(this.filterForm.value.paySlipDate).set("date",1).format("YYYY-MM-DD"),language:localStorage.getItem("Numetric|payroll_lang")??"en",type:t};this.spinner.show(),this.reportsService.getPaySlipReportDoc(i).pipe((0,c.R)(this.unsubscribe$)).subscribe(l=>{const n=document.createElement("a"),d=new Blob([new Uint8Array(l.data.data)],{type:"excel"===t?"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":"application/pdf"}),m=window.URL.createObjectURL(d);n.href=m,n.download=`${this.paySlip?.name}-${this.paySlip?.payroll?.month+", "+this.paySlip?.payroll?.year}`,n.click(),window.URL.revokeObjectURL(m),this.toastr.success(this.translateService.instant("File downloaded"))},l=>{this.toastr.error(this.translateService.instant(l?.error?.error))},()=>this.spinner.hide())}sendEmail(){if(this.email.invalid)return void this.email.markAsDirty();const t={email:this.email.value,paySlipDate:p(this.filterForm.value.paySlipDate).set("date",1).format("YYYY-MM-DD"),empId:this.paySlip._id,language:localStorage.getItem("Numetric|payroll_lang")};this.spinner.show(),this.reportsService.sendEmail(t).pipe((0,c.R)(this.unsubscribe$)).subscribe(i=>{this.spinner.hide(),i?.success?(this.emailModal=!1,this.toastr.success(this.translateService.instant("Email sent successfully"))):this.toastr.error(this.translateService.instant(i?.message)),this.email.reset()},i=>{this.spinner.hide(),this.toastr.error(this.translateService.instant(i?.error?.message||"Email Not Sent"))})}ngOnDestroy(){this.unsubscribe$.next(null),this.unsubscribe$.complete()}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(y),e.Y36(g.m),e.Y36(b.t2),e.Y36(v._W),e.Y36(f.sK),e.Y36(a.qu))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-pay-slip"]],decls:32,vars:30,consts:[[1,"bg-white","rounded-xl","p-4","my-4"],[1,"w-2/3","flex","space-x-2","rtl:space-x-reverse","items-center",3,"formGroup"],[1,"w-1/4"],["bindValue","_id","bindLabel","firstName","formControlName","empId",3,"placeholder","items"],["class","text-sm text-red-500 ms-2 mt-1",4,"ngIf"],[1,"w-1/5"],["type","month","formControlName","paySlipDate",1,"border","p-1.5","rounded-lg"],["type","primary","rounded","true",3,"buttonText","handleClick"],["class","w-1/5",4,"ngIf"],["class","bg-white",4,"ngIf"],[3,"isOpen"],["header","",1,"Gilroy-Bold"],["content","",1,"flex","flex-col",2,"overflow-y","auto"],["for",""],["type","text",1,"w-full","rounded-xl","bg-gray-100","border-0","p-3",3,"formControl"],["class","text-sm text-red-400 ms-2",4,"ngIf"],["footer","",1,"flex","space-x-2","rtl:space-x-reverse"],["type","primary",3,"buttonText","handleClick"],["type","third",3,"buttonText","handleClick"],[1,"text-sm","text-red-500","ms-2","mt-1"],[1,"bg-white"],[1,"left-5","right-5","p-4","space-y-3"],[1,"text-4xl","font-bold"],[1,"w-1/3","space-y-2","ms-4","mt-4"],[1,"flex","space-x-2","rtl:space-x-reverse"],[1,"font-semibold","w-1/3"],[1,""],[1,"w-full","my-2"],[1,"space-y-2","ms-4"],[1,"text-xl","font-bold"],[1,"border","px-4","py-2","rounded-xl","w-1/3","space-y-4"],["class","space-y-2",4,"ngFor","ngForOf"],[1,"flex","w-full"],[1,"space-y-2"],[1,"font-semibold"],[1,"my-2"],[1,"font-medium","w-1/3"],[1,"text-sm","text-red-400","ms-2"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._UZ(3,"ng-select",3),e.ALo(4,"translate"),e.YNc(5,M,2,1,"div",4),e.qZA(),e.TgZ(6,"div",5),e._UZ(7,"input",6),e.YNc(8,L,2,1,"div",4),e.qZA(),e.TgZ(9,"div",5)(10,"app-button",7),e.NdJ("handleClick",function(){return i.getReportData()}),e.ALo(11,"translate"),e.qZA()(),e.YNc(12,P,3,3,"div",8),e.YNc(13,Q,3,3,"div",8),e.YNc(14,k,3,3,"div",8),e.qZA()(),e.YNc(15,B,37,22,"div",9),e.TgZ(16,"app-modal-container",10)(17,"div",11),e._uU(18),e.ALo(19,"translate"),e.qZA(),e.TgZ(20,"div",12)(21,"label",13),e._uU(22),e.ALo(23,"translate"),e.qZA(),e._UZ(24,"input",14),e.YNc(25,G,3,3,"div",15),e.YNc(26,H,3,3,"div",15),e.qZA(),e.TgZ(27,"div",16)(28,"app-button",17),e.NdJ("handleClick",function(){return i.sendEmail()}),e.ALo(29,"translate"),e.qZA(),e.TgZ(30,"app-button",18),e.NdJ("handleClick",function(){return i.emailModal=!1}),e.ALo(31,"translate"),e.qZA()()()),2&t&&(e.xp6(1),e.Q6J("formGroup",i.filterForm),e.xp6(2),e.Q6J("placeholder",e.lcZ(4,18,"Select Employee"))("items",i.employees),e.xp6(2),e.Q6J("ngIf",i.formErrors.empId),e.xp6(3),e.Q6J("ngIf",i.formErrors.paySlipDate),e.xp6(2),e.Q6J("buttonText",e.lcZ(11,20,"Generate")),e.xp6(2),e.Q6J("ngIf",i.paySlip),e.xp6(1),e.Q6J("ngIf",i.paySlip),e.xp6(1),e.Q6J("ngIf",i.paySlip),e.xp6(1),e.Q6J("ngIf",i.paySlip),e.xp6(1),e.Q6J("isOpen",i.emailModal),e.xp6(2),e.Oqu(e.lcZ(19,22,"Share pay-slip via email")),e.xp6(4),e.Oqu(e.lcZ(23,24,"Email")),e.xp6(2),e.Q6J("formControl",i.email),e.xp6(1),e.Q6J("ngIf",i.email.getError("required")&&i.email.dirty),e.xp6(1),e.Q6J("ngIf",i.email.getError("pattern")&&i.email.dirty),e.xp6(2),e.s9C("buttonText",e.lcZ(29,26,"Send")),e.xp6(2),e.s9C("buttonText",e.lcZ(31,28,"Cancel")))},dependencies:[h.sg,h.O5,Z.r,R.O,a.Fj,a.JJ,a.JL,a.oH,a.sg,a.u,S.w9,h.JJ,f.X$]}),r})();function V(r,o){if(1&r&&(e.TgZ(0,"div",14),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.hij(" ",t.formErrors.empId,"")}}function X(r,o){if(1&r&&(e.TgZ(0,"div",14),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.hij(" ",t.formErrors.firstDate,"")}}function z(r,o){if(1&r&&(e.TgZ(0,"div",14),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.hij(" ",t.formErrors.lastDate,"")}}function W(r,o){if(1&r){const t=e.EpF();e.TgZ(0,"div",15)(1,"app-button",11),e.NdJ("handleClick",function(){e.CHM(t);const l=e.oxw();return e.KtG(l.downloadReport("pdf"))}),e.ALo(2,"translate"),e.qZA()()}2&r&&(e.xp6(1),e.Q6J("buttonText",e.lcZ(2,1,"Download PDF")))}function ee(r,o){if(1&r){const t=e.EpF();e.TgZ(0,"div",15)(1,"app-button",11),e.NdJ("handleClick",function(){e.CHM(t);const l=e.oxw();return e.KtG(l.downloadReport("excel"))}),e.ALo(2,"translate"),e.qZA()()}2&r&&(e.xp6(1),e.Q6J("buttonText",e.lcZ(2,1,"Download Excel")))}function te(r,o){if(1&r&&(e.TgZ(0,"th",29),e._uU(1),e.qZA()),2&r){const t=o.$implicit,i=e.oxw(2);let l;e.uIk("colspan",null!==(l=null==i.reportData||null==i.reportData.payroll[0][i.fieldNames[t]+"Break"]?null:i.reportData.payroll[0][i.fieldNames[t]+"Break"].length)&&void 0!==l?l:1),e.xp6(1),e.Oqu(t)}}function re(r,o){if(1&r&&(e.TgZ(0,"th",29),e._uU(1),e.qZA()),2&r){const t=o.$implicit;e.xp6(1),e.Oqu(t)}}function ie(r,o){if(1&r&&(e.TgZ(0,"td",32),e._uU(1),e.qZA()),2&r){const t=o.$implicit;e.xp6(1),e.Oqu(null==t?null:t.amount)}}function oe(r,o){if(1&r&&(e.ynx(0),e.YNc(1,ie,2,1,"td",34),e.BQk()),2&r){const t=o.$implicit,i=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",i[t+"Break"])}}function le(r,o){if(1&r&&(e.TgZ(0,"tr",31)(1,"td",32),e._uU(2),e.qZA(),e.TgZ(3,"td",32),e._uU(4),e.qZA(),e.YNc(5,oe,2,1,"ng-container",33),e.TgZ(6,"th",32),e._uU(7),e.qZA()()),2&r){const t=o.$implicit,i=e.oxw(2);e.xp6(2),e.Oqu(null==t?null:t.sno),e.xp6(2),e.AsE("",null==t?null:t.month,", ",null==t?null:t.year,""),e.xp6(1),e.Q6J("ngForOf",i.fields),e.xp6(2),e.Oqu(null==t?null:t.totalSalary)}}function ae(r,o){if(1&r&&(e.TgZ(0,"div",16)(1,"div",17)(2,"div")(3,"p",18),e._uU(4),e.qZA()(),e.TgZ(5,"div",19)(6,"div",20)(7,"p",21),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"p",22),e._uU(11),e.qZA()(),e.TgZ(12,"div",20)(13,"p",21),e._uU(14),e.ALo(15,"translate"),e.qZA(),e.TgZ(16,"p",22),e._uU(17),e.qZA()()(),e._UZ(18,"hr",23),e.TgZ(19,"div",22)(20,"table",24)(21,"thead",25)(22,"tr",26),e.YNc(23,te,2,2,"th",27),e.qZA(),e.TgZ(24,"tr",28),e.YNc(25,re,2,1,"th",27),e._UZ(26,"th",29),e.qZA()(),e.TgZ(27,"tbody"),e.YNc(28,le,8,5,"tr",30),e.qZA()()()()()),2&r){const t=e.oxw();e.xp6(4),e.Oqu(null==t.reportData?null:t.reportData.name),e.xp6(4),e.hij("",e.lcZ(9,8,"Employee Code"),":"),e.xp6(3),e.Oqu(null==t.reportData?null:t.reportData.empCode),e.xp6(3),e.hij("",e.lcZ(15,10,"Email-Id"),":"),e.xp6(3),e.Oqu(null==t.reportData?null:t.reportData.email),e.xp6(6),e.Q6J("ngForOf",t.tableHeading),e.xp6(2),e.Q6J("ngForOf",t.tableSubHeadings),e.xp6(3),e.Q6J("ngForOf",null==t.reportData?null:t.reportData.payroll)}}const ne=[{path:"",component:(()=>{class r{constructor(){}ngOnInit(){}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-reports"]],decls:7,vars:3,consts:[[1,"space-y-8"],[1,"bg-white","flex","flex-col","rounded-3xl"],[1,"flex","items-center","justify-between","p-6"],[1,"Gilroy-Bold","text-2xl"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"span",3),e._uU(4),e.ALo(5,"translate"),e.qZA()()(),e._UZ(6,"router-outlet"),e.qZA()),2&t&&(e.xp6(4),e.Oqu(e.lcZ(5,1,"Reports")))},dependencies:[x.lC,f.X$]}),r})(),children:[{path:"pay-slip",component:K},{path:"payroll-sheet",component:(()=>{class r{constructor(t,i,l,n,d,m){this.reportsService=t,this.employeService=i,this.spinner=l,this.toastr=n,this.translateService=d,this.fb=m,this.unsubscribe$=new _.x,this.employees=[],this.reportData=null,this.formErrors={empId:"",firstDate:"",lastDate:""},this.formErrorMessages={empId:{required:"Select one employe to proceed"},firstDate:{required:"Start date is required"},lastDate:{required:"End date is required"}},this.fields=["fixedIncome","variableIncome","fixedDeductibles","variableDeductibles"],this.fieldNames={"Fixed Income":"fixedIncome","Variable Income":"variableDeductibles","Fixed Deductibles":"fixedDeductibles","Variable Deductibles":"variableDeductibles"},this.tableHeading=["Sr. No","Month","Fixed Income","Variable Income","Fixed Deductibles","Variable Deductibles","Net Salary"],this.tableKeys=["sno","month","fixedIncome","variableIncome","fixedDeductibles","variableDeductibles","totalSalary"],this.tableSubHeadings=["",""]}ngOnInit(){this.createFilterForm(),this.getEmployees()}createFilterForm(){this.filterForm=this.fb.record({empId:[null,a.kI.required],firstDate:[p().format("YYYY-MM"),a.kI.required],lastDate:[p().format("YYYY-MM"),a.kI.required]}),this.formErrors=(0,u.tm)(this.filterForm,this.formErrors,this.formErrorMessages,this.translateService),this.filterForm.valueChanges.subscribe(()=>{this.formErrors=(0,u.tm)(this.filterForm,this.formErrors,this.formErrorMessages,this.translateService)})}getEmployees(){this.spinner.show(),this.employeService.getAllEmployes().pipe((0,c.R)(this.unsubscribe$)).subscribe(t=>{t?.success?(this.employees=t?.data,this.spinner.hide()):(this.toastr.error(this.translateService.instant(t?.message)),this.spinner.hide())},t=>{this.toastr.error(this.translateService.instant(t?.error?.message)),this.spinner.hide()})}getReportData(){if(this.filterForm.invalid)return this.filterForm.markAllAsTouched(),void(this.formErrors=(0,u.tm)(this.filterForm,this.formErrors,this.formErrorMessages,this.translateService));this.spinner.show();const t={...this.filterForm.value,firstDate:p(this.filterForm.value.firstDate).set("date",1).format("YYYY-MM-DD"),lastDate:p(this.filterForm.value.lastDate).set("date",1).format("YYYY-MM-DD")};this.reportsService.getEmployeReport(t).pipe((0,c.R)(this.unsubscribe$)).subscribe(i=>{i?.success?(this.reportData={...i?.data,payroll:i?.data?.payroll?.map((l,n)=>({sno:n+1,...l}))},this.fields.forEach(l=>{this.reportData?.payroll[0][`${l}Break`]?.forEach(n=>{this.tableSubHeadings.push(n?.name)})}),console.log(this.tableSubHeadings),this.spinner.hide()):(this.toastr.error(this.translateService.instant(i?.message)),this.spinner.hide())},i=>{this.toastr.error(this.translateService.instant(i?.error?.message)),this.spinner.hide()})}downloadReport(t){const i={...this.filterForm.value,firstDate:p(this.filterForm.value.firstDate).set("date",1).format("YYYY-MM-DD"),lastDate:p(this.filterForm.value.lastDate).set("date",1).format("YYYY-MM-DD"),language:localStorage.getItem("Numetric|payroll_lang")??"en",type:t};this.spinner.show(),this.reportsService.getEmployeReportDoc(i).pipe((0,c.R)(this.unsubscribe$)).subscribe(l=>{const n=document.createElement("a"),d=new Blob([new Uint8Array(l.data.data)],{type:"excel"===t?"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":"application/pdf"}),m=window.URL.createObjectURL(d);n.href=m,n.download=this.reportData?.name,n.click(),window.URL.revokeObjectURL(m),this.toastr.success(this.translateService.instant("File downloaded"))},l=>{this.toastr.error(this.translateService.instant(l?.error?.error))},()=>this.spinner.hide())}ngOnDestroy(){this.unsubscribe$.next(null),this.unsubscribe$.complete()}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(y),e.Y36(g.m),e.Y36(b.t2),e.Y36(v._W),e.Y36(f.sK),e.Y36(a.qu))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-payroll-sheet"]],decls:27,vars:25,consts:[[1,"bg-white","rounded-xl","p-4","my-4"],[1,"w-2/3","flex","space-x-2","rtl:space-x-reverse","items-end",3,"formGroup"],[1,"w-[30%]"],["for","",1,"text-sm","font-semibold"],["bindValue","_id","bindLabel","firstName","formControlName","empId",3,"placeholder","items"],["class","text-sm text-red-500 ms-2 mt-1",4,"ngIf"],[1,"w-1/4"],["for","firstDate",1,"text-sm","font-semibold"],["type","month","formControlName","firstDate",1,"border","p-1.5","rounded-lg",3,"max"],["for","lastDate",1,"text-sm","font-semibold"],["type","month","formControlName","lastDate",1,"border","p-1.5","rounded-lg",3,"min"],["type","primary","rounded","true",3,"buttonText","handleClick"],["class","w-1/3",4,"ngIf"],["class","bg-white",4,"ngIf"],[1,"text-sm","text-red-500","ms-2","mt-1"],[1,"w-1/3"],[1,"bg-white"],[1,"left-5","right-5","p-4"],[1,"text-4xl","font-bold"],[1,"w-1/3","space-y-2","ms-4","mt-12"],[1,"flex","space-x-2","rtl:space-x-reverse"],[1,"font-semibold","w-1/3"],[1,""],[1,"w-full","my-8"],[1,"table-fixed","w-full"],[1,"bg-table-header"],[1,"bg-light-gray-1","mb-2"],["class","text-center p-2 first:border-s-0 last:border-e-0 Gilroy-Bold whitespace-nowrap first:rounded-s-3xl first:ps-4 last:pe-4 last:rounded-e-3xl",4,"ngFor","ngForOf"],[1,"bg-light-gray-1","my-2"],[1,"text-center","p-2","first:border-s-0","last:border-e-0","Gilroy-Bold","whitespace-nowrap","first:rounded-s-3xl","first:ps-4","last:pe-4","last:rounded-e-3xl"],["class","box-shadow-sales rounded-3xl mb-4 py-2 px-6 border-gray-200 border-b",4,"ngFor","ngForOf"],[1,"box-shadow-sales","rounded-3xl","mb-4","py-2","px-6","border-gray-200","border-b"],[1,"p-2","whitespace-nowrap","first:ps-4","text-center"],[4,"ngFor","ngForOf"],["class","p-2 whitespace-nowrap first:ps-4 text-center",4,"ngFor","ngForOf"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"label",3),e._uU(4),e.ALo(5,"translate"),e.qZA(),e._UZ(6,"ng-select",4),e.ALo(7,"translate"),e.YNc(8,V,2,1,"div",5),e.qZA(),e.TgZ(9,"div",6)(10,"label",7),e._uU(11),e.ALo(12,"translate"),e.qZA(),e._UZ(13,"input",8),e.YNc(14,X,2,1,"div",5),e.qZA(),e.TgZ(15,"div",6)(16,"label",9),e._uU(17),e.ALo(18,"translate"),e.qZA(),e._UZ(19,"input",10),e.YNc(20,z,2,1,"div",5),e.qZA(),e.TgZ(21,"div",6)(22,"app-button",11),e.NdJ("handleClick",function(){return i.getReportData()}),e.ALo(23,"translate"),e.qZA()(),e.YNc(24,W,3,3,"div",12),e.YNc(25,ee,3,3,"div",12),e.qZA()(),e.YNc(26,ae,29,12,"div",13)),2&t&&(e.xp6(1),e.Q6J("formGroup",i.filterForm),e.xp6(3),e.Oqu(e.lcZ(5,15,"Select Employee")),e.xp6(2),e.Q6J("placeholder",e.lcZ(7,17,"Select Employee"))("items",i.employees),e.xp6(2),e.Q6J("ngIf",i.formErrors.empId),e.xp6(3),e.Oqu(e.lcZ(12,19,"Select From Date")),e.xp6(2),e.Q6J("max",i.filterForm.value.lastDate),e.xp6(1),e.Q6J("ngIf",i.formErrors.firstDate),e.xp6(3),e.Oqu(e.lcZ(18,21,"Select To Date")),e.xp6(2),e.Q6J("min",i.filterForm.value.firstDate),e.xp6(1),e.Q6J("ngIf",i.formErrors.lastDate),e.xp6(2),e.Q6J("buttonText",e.lcZ(23,23,"Generate")),e.xp6(2),e.Q6J("ngIf",i.reportData),e.xp6(1),e.Q6J("ngIf",i.reportData),e.xp6(1),e.Q6J("ngIf",i.reportData))},dependencies:[h.sg,h.O5,Z.r,a.Fj,a.JJ,a.JL,a.sg,a.u,S.w9,f.X$]}),r})()},{path:"company-sheet",component:N}]}];let se=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[x.Bz.forChild(ne),x.Bz]}),r})();var pe=s(4466);let de=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[h.ez,se,pe.m,a.UX,S.A0]}),r})()}}]);