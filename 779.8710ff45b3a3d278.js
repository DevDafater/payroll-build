"use strict";(self.webpackChunkpayroll=self.webpackChunkpayroll||[]).push([[779],{1779:(te,b,n)=>{n.r(b),n.d(b,{PayrollModule:()=>X});var d=n(6895),m=n(4763),p=n(4006),u=n(5439),e=n(4650),A=n(1543);let y=(()=>{class a{constructor(t){this.http=t}getPayrollList(){return this.http.get("api/payroll/getPayrollList")}getPayrollDetails(t){return this.http.get(`api/payroll/getPayrollDetails/${t}`)}checkMonth(t){return this.http.post("api/payroll/initializePayroll",t)}saveDraft(t){return this.http.post("api/payroll/savePayrollDraft",t)}previewPayroll(t){return this.http.get(`api/payroll/getPayrollPdf/${t}`)}approvePayroll(t){return this.http.get(`api/payroll/approvePayroll/${t}`)}}return a.\u0275fac=function(t){return new(t||a)(e.LFG(A.O))},a.\u0275prov=e.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();var g=n(8423),v=n(4383),h=n(4463),f=n(5531),w=n(4294),P=n(656),Z=n(2817),T=n(5262),x=n(6762);function D(a,i){1&a&&(e.TgZ(0,"div",31),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&a&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"Please select month and year to proceed")))}function M(a,i){1&a&&(e.O4$(),e.TgZ(0,"svg",44),e._UZ(1,"path",45),e.qZA())}function S(a,i){1&a&&(e.O4$(),e.TgZ(0,"svg",46),e._UZ(1,"path",47),e.qZA())}function L(a,i){if(1&a){const t=e.EpF();e.TgZ(0,"span",42),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit,r=e.oxw();return e.KtG(r.markAsReview(o._id))}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&a&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"Mark as Reviewed")))}function k(a,i){if(1&a){const t=e.EpF();e.TgZ(0,"td",32),e.YNc(1,M,2,0,"svg",33),e.YNc(2,S,2,0,"svg",34),e.qZA(),e.TgZ(3,"td",35)(4,"div")(5,"app-dropdown",null,36)(7,"div",37),e.NdJ("click",function(){e.CHM(t);const o=e.MAs(6);return e.KtG(o.open=!0)})("clickOutside",function(){e.CHM(t);const o=e.MAs(6);return e.KtG(o.open=!1)}),e.TgZ(8,"div",38),e.O4$(),e.TgZ(9,"svg",39),e._UZ(10,"path",40),e.qZA()()(),e.kcU(),e.TgZ(11,"div",41)(12,"span",42),e.NdJ("click",function(){const r=e.CHM(t).$implicit,s=e.oxw();return e.KtG(s.editDetails(r._id))}),e._uU(13),e.ALo(14,"translate"),e.qZA(),e.YNc(15,L,3,3,"span",43),e.qZA()()()()}if(2&a){const t=i.$implicit;e.xp6(1),e.Q6J("ngIf",null==t?null:t.isReviewed),e.xp6(1),e.Q6J("ngIf",!(null!=t&&t.isReviewed)),e.xp6(11),e.Oqu(e.lcZ(14,4,"Edit")),e.xp6(2),e.Q6J("ngIf",!(null!=t&&t.isReviewed))}}function q(a,i){if(1&a&&(e.TgZ(0,"p",54),e._uU(1),e.qZA()),2&a){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",!0===(null==t||null==t.value?null:t.value.isPercentage)?null==t||null==t.value?null:t.value.amount:null==t||null==t.value?null:t.value.value," ")}}function O(a,i){1&a&&(e.TgZ(0,"p",62),e._UZ(1,"input",63),e.qZA())}function Y(a,i){if(1&a&&(e.ynx(0),e.TgZ(1,"div",58)(2,"p",59),e._uU(3),e.qZA(),e.TgZ(4,"p",53),e._uU(5),e.qZA(),e.YNc(6,q,2,1,"p",60),e.YNc(7,O,2,0,"p",61),e.qZA(),e.BQk()),2&a){const t=i.$implicit,l=e.oxw().$implicit;e.xp6(1),e.Q6J("formGroup",t),e.xp6(2),e.hij(" ",null==t||null==t.value?null:t.value.name," "),e.xp6(2),e.hij(" ",null!=t&&null!=t.value&&t.value.isPercentage?(null==t||null==t.value?null:t.value.value)+"%":"-"," "),e.xp6(1),e.Q6J("ngIf",l.startsWith("fixed")),e.xp6(1),e.Q6J("ngIf",!l.startsWith("fixed"))}}function N(a,i){if(1&a&&(e.TgZ(0,"div",48)(1,"div",49),e._uU(2),e.qZA(),e.TgZ(3,"div",50)(4,"div",51)(5,"p",52),e._uU(6),e.ALo(7,"translate"),e.qZA(),e.TgZ(8,"p",53),e._uU(9),e.ALo(10,"translate"),e.qZA(),e.TgZ(11,"p",54),e._uU(12),e.ALo(13,"translate"),e.qZA()(),e._UZ(14,"hr",55),e.ynx(15,56),e.YNc(16,Y,8,5,"ng-container",57),e.BQk(),e.qZA()()),2&a){const t=i.$implicit,l=e.oxw();e.xp6(2),e.hij(" ",l.fieldNames[t]," "),e.xp6(4),e.Oqu(e.lcZ(7,6,"Name")),e.xp6(3),e.Oqu(e.lcZ(10,8,"Percentage")),e.xp6(3),e.Oqu(e.lcZ(13,10,"Value")),e.xp6(3),e.Q6J("formArrayName",t),e.xp6(1),e.Q6J("ngForOf",l.employeForm.get(t).controls)}}let C=(()=>{class a{constructor(t,l,o,r,s,c,_){this.fb=t,this.route=l,this.payrollService=o,this.spinner=r,this.toast=s,this.translateService=c,this.languageService=_,this.selectedMonth=new p.NI(u().format("YYYY-MM"),p.kI.required),this.today=u().format("YYYY-MM"),this.employees=[],this.tableData=[],this.tableKeys=["empCode","name","salary","totalSalary","isQailified"],this.tableHeadings=this.languageService.translateArray(["Employe Code","Employe Name","Monthly Salary","Total Salary","Compliant","Reviewed","Actions"]),this.fields=["fixedIncome","variableIncome","fixedDeductibles","variableDeductibles"],this.fieldNames={fixedIncome:"Fixed Income",variableIncome:"Variable Income",fixedDeductibles:"Fixed Deductibles",variableDeductibles:"Variable Deductibles"},this.showEditForm=!1,this.employeToEdit=null,this.totalSalary=0,this.payrollDetails=null}ngOnInit(){this.createEmployeForm(),this.route.queryParams.subscribe(t=>{t.id&&this.getPayrollDetails(t.id)},t=>{this.toast.error(this.translateService.instant(t?.error?.error))}),this.selectedMonth.valueChanges.subscribe(t=>{this.employees=[],this.tableData=[]})}createEmployeForm(){this.employeForm=this.fb.group({fixedIncome:this.fb.array([]),variableIncome:this.fb.array([]),fixedDeductibles:this.fb.array([]),variableDeductibles:this.fb.array([])}),this.employeForm.valueChanges.subscribe(t=>{this.totalSalary=0,this.fields.forEach(l=>{t[l].forEach(o=>{l.toLowerCase().includes("income")&&(this.totalSalary+=Number(o?.amount??0)),l.toLowerCase().includes("deductibles")&&(this.totalSalary-=Number(o?.amount??0))})})})}getPayrollDetails(t){this.spinner.show(),this.payrollService.getPayrollDetails(t).subscribe(l=>{l?.success?(this.payrollDetails=l?.data,this.selectedMonth.setValue(u().set("month",this.payrollDetails?.month).set("year",this.payrollDetails?.year).format("YYYY-MM"),{emitEvent:!1}),this.employees=this.payrollDetails?.empSalary,this.tableData=this.employees):this.toast.error(this.translateService.instant(l?.message))},l=>{this.toast.error(this.translateService.instant(l?.error?.error)),this.spinner.hide()},()=>this.spinner.hide())}checkMonth(){this.spinner.show();const t={month:u(this.selectedMonth.value).format("MMMM"),year:u(this.selectedMonth.value).format("YYYY")};this.payrollService.checkMonth(t).subscribe(l=>{l?.success?(this.employees=l?.data,this.tableData=this.employees.map(o=>({...o,isQailified:o?.isQualify?"Yes":"No",isReviewed:o?.isReviewed??!1}))):this.toast.error(this.translateService.instant(l?.message))},l=>{this.toast.error(l?.error.error),this.spinner.hide()},()=>this.spinner.hide())}editDetails(t){this.fields.forEach(r=>{this.employeForm.get(r).clear()});let l=this.employees.findIndex(r=>r?._id===t);this.indexOfEditedEmploye=l;const o=this.employees[l];this.employeToEdit=o,this.fields.forEach(r=>{o[r].forEach(s=>{this.employeForm.get(r).push(this.newItem(s))})}),this.showEditForm=!0}newItem(t){return this.fb.group({name:t?.name,isPercentage:t?.isPercentage,value:t?.value,amount:t?.amount})}saveChanges(){this.tableData=this.tableData.map((t,l)=>l===this.indexOfEditedEmploye?{...t,...this.employeForm.value,totalSalary:this.totalSalary,isReviewed:!1}:t),this.saveDraft(),this.showEditForm=!1}markAsReview(t){this.spinner.show(),setTimeout(()=>{this.tableData=this.tableData?.map(l=>(l?._id===t&&(l.isReviewed=!0),l)),this.spinner.hide()},1e3)}saveDraft(){if(!this.tableData.length||this.selectedMonth.invalid)return void(this.selectedMonth.invalid?this.selectedMonth.markAsTouched():this.toast.error("No employees available for the selected month"));if(this.tableData?.some(l=>!l?.isQualify)&&this.payrollDetails?._id)return void this.toast.error("All employees must be compliant with latest salary breakdown, revise salary for non-compliant employee");const t={month:u(this.selectedMonth.value).format("MMMM"),year:u(this.selectedMonth.value).format("YYYY"),empSalary:this.tableData};this.spinner.show(),this.payrollService.saveDraft(t).subscribe(l=>{l?.success?(this.toast.success(l?.message),this.employees=l?.data?.empSalary,this.tableData=l?.data?.empSalary):this.toast.error(l?.message)},l=>{this.toast.error(l?.error.error)},()=>this.spinner.hide())}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(p.qu),e.Y36(m.gz),e.Y36(y),e.Y36(g.t2),e.Y36(v._W),e.Y36(h.sK),e.Y36(f.T))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-create-payroll"]],decls:63,vars:42,consts:[[1,"space-y-8"],[1,"bg-white","pb-6","flex","flex-col","rounded-3xl"],[1,"flex","items-center","justify-between","p-6"],[1,"Gilroy-Bold","text-xl"],["type","primary","rounded","true",3,"buttonText","handleClick"],[1,"flex","bg-white","rounded-3xl","px-4","pt-4"],[1,"flex","w-1/4","items-center","justify-center","mb-6","space-x-2","rtl:space-x-reverse"],[1,"Gilroy-Bold"],[1,"w-2/4"],["type","month",1,"bg-input","border-[1px]","h-11","p-1",3,"formControl","min"],["class","text-red-500",4,"ngIf"],["type","primary",3,"buttonText","handleClick"],[1,"my-4","bg-white","rounded"],[1,"space-y-2"],[1,"flex","flex-col","rounded-3xl"],[1,"Gilroy-Bold","text-lg"],[1,"p-4"],[3,"tableData","keys","tableHeadings","actionTemplate"],["actionTemplate",""],[3,"isOpen"],["header","",1,"font-semibold","text-lg"],["content","",3,"formGroup"],[1,"flex","justify-evenly","space-x-3","rtl:space-x-reverse","border","rounded","p-2"],[1,"flex","space-x-2","rtl:space-x-reverse"],[1,"font-semibold"],[1,"border","rounded","p-3","my-4","space-y-3"],["class","w-full  space-x-4 rtl:space-x-reverse",4,"ngFor","ngForOf"],[1,"flex","justify-between","space-x-3","rtl:space-x-reverse","mt-3","border","rounded","p-2"],[1,"flex","space-x-2","rtl:space-x-reverse","text-lg"],["footer","",1,"space-x-2","rtl:space-x-reverse"],["type","third",3,"buttonText","handleClick"],[1,"text-red-500"],[1,"p-2","whitespace-nowrap","first:pl-4"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","green","class","w-6 h-6",4,"ngIf"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","red","class","w-6 h-6",4,"ngIf"],["align","right",1,"p-2","last:pe-10","text-start"],["dropdown",""],["button","",3,"click","clickOutside"],[1,"h-8","w-8","rounded-full","flex","justify-center","items-center","bg-gray-50","border","border-gray-200"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-4","w-4","m-auto","leading-8","text-center"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 9l-7 7-7-7"],["options","",1,"shadow","rounded-xl"],[1,"cursor-pointer","block","px-4","py-2","text-sm","Gilroy-Bold","hover:bg-gray-50","hover:rounded-xl","text-center",3,"click"],["class","cursor-pointer block px-4 py-2 text-sm Gilroy-Bold hover:bg-gray-50 hover:rounded-xl text-center",3,"click",4,"ngIf"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","green",1,"w-6","h-6"],["fill-rule","evenodd","d","M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm13.36-1.814a.75.75 0 10-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 00-1.06 1.06l2.25 2.25a.75.75 0 001.14-.094l3.75-5.25z","clip-rule","evenodd"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","red",1,"w-6","h-6"],["fill-rule","evenodd","d","M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25zm-1.72 6.97a.75.75 0 10-1.06 1.06L10.94 12l-1.72 1.72a.75.75 0 101.06 1.06L12 13.06l1.72 1.72a.75.75 0 101.06-1.06L13.06 12l1.72-1.72a.75.75 0 10-1.06-1.06L12 10.94l-1.72-1.72z","clip-rule","evenodd"],[1,"w-full","space-x-4","rtl:space-x-reverse"],[1,"w-full","text-left","px-4","font-semibold","mb-2"],[1,"w-[95%]","box-shadow","bg-gray-50","px-4","py-2","rounded-md"],[1,"w-full","justify-between","flex","my-2","font-semibold"],[1,"w-1/3"],[1,"w-1/3","text-center"],[1,"w-1/3","text-end"],[1,"w-full","my-1","bg-black"],[3,"formArrayName"],[4,"ngFor","ngForOf"],[1,"w-full","justify-between","flex","my-2",3,"formGroup"],[1,"w-1/3","text-start"],["class","w-1/3 text-end",4,"ngIf"],["class","w-1/3 flex justify-end",4,"ngIf"],[1,"w-1/3","flex","justify-end"],["type","text","id","exampleText0","formControlName","amount",1,"form-control","block","w-1/4","px-3","py-1.5","text-base","font-normal","text-gray-700","bg-white","bg-clip-padding","border","border-solid","border-gray-300","rounded","transition","ease-in-out","m-0","focus:text-gray-700","focus:bg-white","focus:border-blue-600","focus:outline-none"]],template:function(t,l){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"span",3),e._uU(4),e.ALo(5,"translate"),e.qZA(),e.TgZ(6,"app-button",4),e.NdJ("handleClick",function(){return l.saveDraft()}),e.ALo(7,"translate"),e.qZA()()()(),e.TgZ(8,"div",5)(9,"div",6)(10,"label",7),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"fieldset",8),e._UZ(14,"input",9),e.YNc(15,D,3,3,"div",10),e.qZA()(),e.TgZ(16,"app-button",11),e.NdJ("handleClick",function(){return l.checkMonth()}),e.ALo(17,"translate"),e.qZA()(),e.TgZ(18,"div",12)(19,"div",13)(20,"div",14)(21,"div",2)(22,"span",15),e._uU(23),e.ALo(24,"translate"),e.qZA()()()(),e.TgZ(25,"div",16)(26,"app-table-container",17),e.YNc(27,k,16,6,"ng-template",null,18,e.W1O),e.qZA()()(),e.TgZ(29,"app-modal-container",19)(30,"div",20),e._uU(31),e.ALo(32,"translate"),e.qZA(),e.TgZ(33,"div",21)(34,"div",22)(35,"div",23)(36,"p",24),e._uU(37),e.qZA(),e.TgZ(38,"p"),e._uU(39),e.qZA()(),e.TgZ(40,"div",23)(41,"p",24),e._uU(42),e.qZA(),e.TgZ(43,"p"),e._uU(44),e.qZA()()(),e.TgZ(45,"div",25),e.YNc(46,N,17,12,"div",26),e.qZA(),e.TgZ(47,"div",27)(48,"div",28)(49,"p",24),e._uU(50),e.qZA(),e.TgZ(51,"p"),e._uU(52),e.qZA()(),e.TgZ(53,"div",28)(54,"p",24),e._uU(55),e.qZA(),e.TgZ(56,"p"),e._uU(57),e.qZA()()()(),e.TgZ(58,"div",29)(59,"app-button",11),e.NdJ("handleClick",function(){return l.saveChanges()}),e.ALo(60,"translate"),e.qZA(),e.TgZ(61,"app-button",30),e.NdJ("handleClick",function(){return l.showEditForm=!1}),e.ALo(62,"translate"),e.qZA()()()),2&t){const o=e.MAs(28);e.xp6(4),e.Oqu(e.lcZ(5,26,"Create New Payroll")),e.xp6(2),e.Q6J("buttonText",e.lcZ(7,28,"Save Draft")),e.xp6(5),e.hij("",e.lcZ(12,30,"Applicable Month"),":"),e.xp6(3),e.Q6J("formControl",l.selectedMonth)("min",l.today),e.xp6(1),e.Q6J("ngIf",l.selectedMonth.hasError("required")||!l.selectedMonth.value),e.xp6(1),e.Q6J("buttonText",e.lcZ(17,32,"Calculate")),e.xp6(7),e.Oqu(e.lcZ(24,34,"Employees")),e.xp6(3),e.Q6J("tableData",l.tableData)("keys",l.tableKeys)("tableHeadings",l.tableHeadings)("actionTemplate",o),e.xp6(3),e.Q6J("isOpen",l.showEditForm),e.xp6(2),e.hij(" ",e.lcZ(32,36,"Edit Employe Details")," "),e.xp6(2),e.Q6J("formGroup",l.employeForm),e.xp6(4),e.hij("","Employe Name",":"),e.xp6(2),e.Oqu(null==l.employeToEdit?null:l.employeToEdit.name),e.xp6(3),e.hij("","Employe Code",":"),e.xp6(2),e.Oqu(null==l.employeToEdit?null:l.employeToEdit.empCode),e.xp6(2),e.Q6J("ngForOf",l.fields),e.xp6(4),e.hij("","Monthly Salary",":"),e.xp6(2),e.Oqu(null==l.employeToEdit?null:l.employeToEdit.salary),e.xp6(3),e.hij("","Net Salary",":"),e.xp6(2),e.Oqu(l.totalSalary),e.xp6(2),e.s9C("buttonText",e.lcZ(60,38,"Save")),e.xp6(2),e.s9C("buttonText",e.lcZ(62,40,"Cancel"))}},dependencies:[d.sg,d.O5,w.r,P.O,Z.J,T._,x.t,p.Fj,p.JJ,p.JL,p.oH,p.sg,p.u,p.CE,h.X$],styles:[".box-shadow[_ngcontent-%COMP%]{box-shadow:#3c40434d 0 1px 2px,#3c404326 0 2px 6px 2px}"]}),a})();var U=n(7579),E=n(2722);function F(a,i){if(1&a){const t=e.EpF();e.TgZ(0,"span",15),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit,r=e.oxw();return e.KtG(r.approvePayroll(o._id))}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&a&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"Approve Payroll")))}function J(a,i){if(1&a){const t=e.EpF();e.TgZ(0,"td",8)(1,"div")(2,"app-dropdown",null,9)(4,"div",10),e.NdJ("click",function(){e.CHM(t);const o=e.MAs(3);return e.KtG(o.open=!0)})("clickOutside",function(){e.CHM(t);const o=e.MAs(3);return e.KtG(o.open=!1)}),e.TgZ(5,"div",11),e.O4$(),e.TgZ(6,"svg",12),e._UZ(7,"path",13),e.qZA()()(),e.kcU(),e.TgZ(8,"div",14)(9,"span",15),e.NdJ("click",function(){const r=e.CHM(t).$implicit,s=e.oxw();return e.KtG(s.viewEditPayroll(r._id,"view"))}),e._uU(10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"span",15),e.NdJ("click",function(){const r=e.CHM(t).$implicit,s=e.oxw();return e.KtG(s.viewEditPayroll(r._id,"edit"))}),e._uU(13),e.ALo(14,"translate"),e.qZA(),e.YNc(15,F,3,3,"span",16),e.TgZ(16,"span",15),e.NdJ("click",function(){const r=e.CHM(t).$implicit,s=e.oxw();return e.KtG(s.previewPayroll(r._id))}),e._uU(17),e.ALo(18,"translate"),e.qZA()()()()()}if(2&a){const t=i.$implicit;e.xp6(10),e.Oqu(e.lcZ(11,4,"View")),e.xp6(3),e.Oqu(e.lcZ(14,6,"Edit")),e.xp6(2),e.Q6J("ngIf",!(null!=t&&t.isApproved)),e.xp6(2),e.Oqu(e.lcZ(18,8,"Preview Payroll"))}}function j(a,i){1&a&&e.GkF(0)}const Q=function(a){return{$implicit:a}};function $(a,i){if(1&a&&(e.TgZ(0,"div",14),e.YNc(1,j,1,0,"ng-container",15),e.qZA()),2&a){const t=i.$implicit;e.oxw();const l=e.MAs(20);e.xp6(1),e.Q6J("ngTemplateOutlet",l)("ngTemplateOutletContext",e.VKq(2,Q,t))}}function B(a,i){1&a&&(e.O4$(),e.TgZ(0,"svg",19),e._UZ(1,"path",20),e.qZA())}function G(a,i){1&a&&(e.O4$(),e.TgZ(0,"svg",21),e._UZ(1,"path",22),e.qZA())}function H(a,i){if(1&a&&(e.TgZ(0,"td",16),e.YNc(1,B,2,0,"svg",17),e.YNc(2,G,2,0,"svg",18),e.qZA()),2&a){const t=i.$implicit;e.xp6(1),e.Q6J("ngIf",null==t?null:t.isReviewed),e.xp6(1),e.Q6J("ngIf",!(null!=t&&t.isReviewed))}}function V(a,i){if(1&a&&(e.TgZ(0,"div",23)(1,"p",24),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"p",25),e._uU(5),e.qZA()()),2&a){const t=i.$implicit,l=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,2,l.fieldNames[t])),e.xp6(3),e.Oqu(l.payrollDetails[t])}}const R=[{path:"",component:(()=>{class a{constructor(t,l,o,r,s,c){this.spinner=t,this.toast=l,this.payrolService=o,this.translateService=r,this.languageService=s,this.router=c,this.unsubscribe=new U.x,this.payrollList=[],this.tableKeys=["srNo","month","isApproved","approvedDate","totalSalary"],this.tableHeadings=this.languageService.translateArray(["Sr No.","Month/Year","Approved","Approval Date","Total Amount","Action"])}ngOnInit(){this.getPayrollList()}getPayrollList(){this.spinner.show(),this.payrolService.getPayrollList().subscribe(t=>{t?.success?this.payrollList=t?.data.map((l,o)=>({...l,srNo:o+1})):this.toast.error(this.translateService.instant(t?.error))},t=>{this.toast.error(this.translateService.instant(t?.error?.error))},()=>this.spinner.hide())}viewEditPayroll(t,l){this.router.navigate([`/pages/payroll/${"edit"===l?"create":"view"}-payroll`],{queryParams:{id:t}})}approvePayroll(t){this.spinner.show(),this.payrolService.approvePayroll(t).pipe((0,E.R)(this.unsubscribe)).subscribe(l=>{l?.success?(this.toast.success(this.translateService.instant(l?.message)),this.payrollList=this.payrollList.map(o=>(o?._id===t&&(o.isApproved=!0),o)),this.spinner.hide()):(this.toast.error(this.translateService.instant(l?.error)),this.spinner.hide())},l=>{this.toast.error(this.translateService.instant(l?.error?.error)),this.spinner.hide()})}previewPayroll(t){this.spinner.show(),this.payrolService.previewPayroll(t).subscribe(l=>{const o=document.createElement("a"),r=new Blob([new Uint8Array(l.data.data)],{type:"application/pdf"}),s=window.URL.createObjectURL(r);o.href=s;const c=this.payrollList.find(ee=>ee?._id===t);o.download=c?.month+", "+c?.year+".pdf",o.click(),window.URL.revokeObjectURL(s),this.toast.success(this.translateService.instant("File downloaded"))},l=>{this.toast.error(this.translateService.instant(l?.error?.error))},()=>this.spinner.hide())}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(g.t2),e.Y36(v._W),e.Y36(y),e.Y36(h.sK),e.Y36(f.T),e.Y36(m.F0))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-list-payroll"]],decls:12,vars:10,consts:[[1,"space-y-8"],[1,"bg-white","pb-6","flex","flex-col","rounded-3xl"],[1,"flex","items-center","justify-between","p-6"],[1,"Gilroy-Bold","text-lg"],["routerLink","./create-payroll","type","primary","rounded","true",3,"buttonText"],[1,"mx-4"],[3,"tableData","keys","tableHeadings","actionTemplate"],["actionTemplate",""],["align","right",1,"p-2","last:pe-10","text-start"],["dropdown",""],["button","",3,"click","clickOutside"],[1,"h-8","w-8","rounded-full","flex","justify-center","items-center","bg-gray-50","border","border-gray-200"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-4","w-4","m-auto","leading-8","text-center"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 9l-7 7-7-7"],["options","",1,"shadow","rounded-xl"],[1,"cursor-pointer","block","px-4","py-2","text-sm","Gilroy-Bold","hover:bg-gray-50","hover:rounded-xl","text-center",3,"click"],["class","cursor-pointer block px-4 py-2 text-sm Gilroy-Bold hover:bg-gray-50 hover:rounded-xl text-center",3,"click",4,"ngIf"]],template:function(t,l){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"span",3),e._uU(4),e.ALo(5,"translate"),e.qZA(),e._UZ(6,"app-button",4),e.ALo(7,"translate"),e.qZA(),e.TgZ(8,"div",5)(9,"app-table-container",6),e.YNc(10,J,19,10,"ng-template",null,7,e.W1O),e.qZA()()()()),2&t){const o=e.MAs(11);e.xp6(4),e.Oqu(e.lcZ(5,6,"Payroll List")),e.xp6(2),e.Q6J("buttonText",e.lcZ(7,8,"Create Payroll")),e.xp6(3),e.Q6J("tableData",l.payrollList)("keys",l.tableKeys)("tableHeadings",l.tableHeadings)("actionTemplate",o)}},dependencies:[d.O5,m.rH,w.r,Z.J,T._,x.t,h.X$]}),a})()},{path:"create-payroll",component:C},{path:"edit-payroll",component:C},{path:"view-payroll",component:(()=>{class a{constructor(t,l,o,r,s,c){this.route=t,this.payrollService=l,this.spinner=o,this.toast=r,this.translateService=s,this.languageService=c,this.payrollDetails=null,this.employees=[],this.tableData=[],this.tableKeys=["empCode","name","salary","totalSalary"],this.tableHeadings=this.languageService.translateArray(["Employe Code","Employe Name","Monthly Salary","Total Salary","Reviewed"]),this.fields=["totalFixedIncome","totalVariableIncome","totalFixedDeductibles","totalVariableDeductibles"],this.fieldNames={totalFixedIncome:"Total Fixed Income",totalVariableIncome:"Total Variable Income",totalFixedDeductibles:"Total Fixed Deductibles",totalVariableDeductibles:"Total Variable Deductibles"}}ngOnInit(){this.route.queryParams.subscribe(t=>{t.id&&this.getPayrollDetails(t.id)},t=>{this.toast.error(this.translateService.instant(t?.error?.error))})}getPayrollDetails(t){this.spinner.show(),this.payrollService.getPayrollDetails(t).subscribe(l=>{l?.success?(this.payrollDetails=l?.data,this.employees=this.payrollDetails?.empSalary,this.tableData=this.employees):this.toast.error(this.translateService.instant(l?.message))},l=>{this.toast.error(this.translateService.instant(l?.error?.error)),this.spinner.hide()},()=>this.spinner.hide())}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(m.gz),e.Y36(y),e.Y36(g.t2),e.Y36(v._W),e.Y36(h.sK),e.Y36(f.T))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-view-payroll"]],decls:21,vars:12,consts:[[1,"space-y-8"],[1,"bg-white","pb-6","flex","flex-col","rounded-3xl"],[1,"flex","items-center","justify-between","p-6"],[1,"Gilroy-Bold","text-xl"],[1,"flex","space-x-2","rtl:space-x-reverse","my-4","justify-around","rounded-3xl"],["class","w-1/5 ",4,"ngFor","ngForOf"],[1,"bg-white","rounded"],[1,"space-y-2"],[1,"flex","flex-col","rounded-3xl"],[1,"Gilroy-Bold","text-lg"],[1,"p-4"],[3,"tableData","keys","tableHeadings","actionTemplate"],["actionTemplate",""],["cardTemplate",""],[1,"w-1/5"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"p-2","whitespace-nowrap","first:pl-4"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","green","class","w-6 h-6",4,"ngIf"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","red","class","w-6 h-6",4,"ngIf"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","green",1,"w-6","h-6"],["fill-rule","evenodd","d","M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm13.36-1.814a.75.75 0 10-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 00-1.06 1.06l2.25 2.25a.75.75 0 001.14-.094l3.75-5.25z","clip-rule","evenodd"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","red",1,"w-6","h-6"],["fill-rule","evenodd","d","M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25zm-1.72 6.97a.75.75 0 10-1.06 1.06L10.94 12l-1.72 1.72a.75.75 0 101.06 1.06L12 13.06l1.72 1.72a.75.75 0 101.06-1.06L13.06 12l1.72-1.72a.75.75 0 10-1.06-1.06L12 10.94l-1.72-1.72z","clip-rule","evenodd"],[1,"box-shadow","bg-white","rounded","text-center","py-6","px-4","space-y-2"],[1,"font-bold","text-lg"],[1,"font-extrabold","text-2xl"]],template:function(t,l){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"span",3),e._uU(4),e.ALo(5,"translate"),e.qZA()()()(),e.TgZ(6,"div",4),e.YNc(7,$,2,4,"div",5),e.qZA(),e.TgZ(8,"div",6)(9,"div",7)(10,"div",8)(11,"div",2)(12,"span",9),e._uU(13),e.ALo(14,"translate"),e.qZA()()()(),e.TgZ(15,"div",10)(16,"app-table-container",11),e.YNc(17,H,3,2,"ng-template",null,12,e.W1O),e.qZA()()(),e.YNc(19,V,6,4,"ng-template",null,13,e.W1O)),2&t){const o=e.MAs(18);e.xp6(4),e.AsE("",(null==l.payrollDetails?null:l.payrollDetails.month)+", "+(null==l.payrollDetails?null:l.payrollDetails.year)," ",e.lcZ(5,8,"Payroll"),""),e.xp6(3),e.Q6J("ngForOf",l.fields),e.xp6(6),e.Oqu(e.lcZ(14,10,"Employees")),e.xp6(3),e.Q6J("tableData",l.tableData)("keys",l.tableKeys)("tableHeadings",l.tableHeadings)("actionTemplate",o)}},dependencies:[d.sg,d.O5,d.tP,x.t,h.X$],styles:[".box-shadow[_ngcontent-%COMP%]{box-shadow:#3c40434d 0 1px 2px,#3c404326 0 2px 6px 2px}"]}),a})()}];let K=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[m.Bz.forChild(R),m.Bz]}),a})();var z=n(2074),W=n(4466);let X=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[d.ez,K,W.m,p.UX,z.A0]}),a})()}}]);